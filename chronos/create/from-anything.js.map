{"version":3,"sources":["../../../.tmp/chronos/create/from-anything.ts"],"names":[],"mappings":"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","file":"from-anything.js","sourceRoot":"","sourcesContent":["// tslint:disable:max-line-length\r\nimport { isArray, isNumber, isObject, isObjectEmpty, isString, isUndefined } from '../utils/type-checks';\r\nimport { DateParsingConfig } from './parsing.types';\r\nimport { getLocale } from '../locale/locales';\r\nimport { setOffsetToUTC } from '../units/offset';\r\nimport { add } from '../moment/add-subtract';\r\nimport { createInvalid, isValid } from './valid';\r\nimport { isDate } from 'rxjs/util/isDate';\r\nimport { configFromStringAndArray } from './from-string-and-array';\r\nimport { configFromStringAndFormat } from './from-string-and-format';\r\nimport { cloneDate } from './clone';\r\nimport { configFromString } from './from-string';\r\nimport { configFromArray } from './from-array';\r\nimport { configFromObject } from './from-object';\r\nimport { checkOverflow } from './check-overflow';\r\nimport { DateArray, DateObject } from '../types';\r\nimport { DateInput } from '../test/chain';\r\n\r\nfunction createFromConfig(config: DateParsingConfig): DateParsingConfig {\r\n  const res = checkOverflow(prepareConfig(config));\r\n  // todo: remove, in moment.js it's never called cuz of moment constructor\r\n  res._d = new Date(res._d != null ? res._d.getTime() : NaN);\r\n  if (!isValid(Object.assign({}, res, {_isValid: null}))) {\r\n    res._d = new Date(NaN);\r\n  }\r\n  // todo: update offset\r\n  /*if (res._nextDay) {\r\n    // Adding is smart enough around DST\r\n    res._d = add(res._d, 1, 'day');\r\n    res._nextDay = undefined;\r\n  }*/\r\n\r\n  return res;\r\n}\r\n\r\nexport function prepareConfig(config: DateParsingConfig): DateParsingConfig {\r\n  let input = config._i;\r\n  const format = config._f;\r\n\r\n  config._locale = config._locale || getLocale(config._l);\r\n\r\n  if (input === null || (format === undefined && input === '')) {\r\n    return createInvalid(config, { nullInput: true });\r\n  }\r\n\r\n  if (isString(input)) {\r\n    config._i = input = config._locale.preparse(input);\r\n  }\r\n\r\n  if (isDate(input)) {\r\n    config._d = cloneDate(input);\r\n\r\n    return config;\r\n  }\r\n\r\n  // todo: add check for recursion\r\n\r\n  if (isArray(format)) {\r\n    configFromStringAndArray(config);\r\n  } else if (format) {\r\n    configFromStringAndFormat(config);\r\n  } else {\r\n    configFromInput(config);\r\n  }\r\n\r\n  if (!isValid(config)) {\r\n    config._d = null;\r\n  }\r\n\r\n  return config;\r\n}\r\n\r\nfunction configFromInput(config: DateParsingConfig): DateParsingConfig {\r\n  const input = config._i;\r\n  if (isUndefined(input)) {\r\n    config._d = new Date();\r\n  } else if (isDate(input)) {\r\n    config._d = cloneDate(input);\r\n  } else if (isString(input)) {\r\n    configFromString(config);\r\n  } else if (isArray<string | number>(input) && input.length) {\r\n    const _arr: (string | number)[] = input.slice(0);\r\n    config._a = _arr.map(obj => isString(obj) ? parseInt(obj, 10) : obj);\r\n    configFromArray(config);\r\n  } else if (isObject(input)) {\r\n    configFromObject(config);\r\n  } else if (isNumber(input)) {\r\n    // from milliseconds\r\n    config._d = new Date(input);\r\n  } else {\r\n    //   hooks.createFromInputFallback(config);\r\n    return createInvalid(config);\r\n  }\r\n\r\n  return config;\r\n}\r\n\r\nexport function createLocalOrUTC(input: DateInput, format?: string | string[], localeKey?: string, strict?: boolean, isUTC?: boolean): DateParsingConfig {\r\n  const config: DateParsingConfig = {};\r\n  let _input = input;\r\n\r\n  // params switch -> skip; test it well\r\n  // if (localeKey === true || localeKey === false) {\r\n  //     strict = localeKey;\r\n  //     localeKey = undefined;\r\n  // }\r\n\r\n  // todo: fail fast and return not valid date\r\n  if ((isObject(_input) && isObjectEmpty(_input)) || (isArray(_input) && _input.length === 0)) {\r\n    _input = undefined;\r\n  }\r\n  // object construction must be done this way.\r\n  // https://github.com/moment/moment/issues/1423\r\n  // config._isAMomentObject = true;\r\n  config._useUTC = config._isUTC = isUTC;\r\n  config._l = localeKey;\r\n  config._i = _input;\r\n  config._f = format;\r\n  config._strict = strict;\r\n\r\n  return createFromConfig(config);\r\n}\r\n"]}